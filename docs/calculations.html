<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.3 Calculations | Planning Tool Guidance</title>
  <meta name="description" content="This html is to provide you with guidance on how to use the BATCH interface." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="6.3 Calculations | Planning Tool Guidance" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This html is to provide you with guidance on how to use the BATCH interface." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.3 Calculations | Planning Tool Guidance" />
  
  <meta name="twitter:description" content="This html is to provide you with guidance on how to use the BATCH interface." />
  

<meta name="author" content="Project Big Life" />


<meta name="date" content="2019-06-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariable-predictive-risk-algorithms.html">
<link rel="next" href="health-interventions-scenarios.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BATCH Guidance</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to Project Big Life’s Planning Tool</a><ul>
<li class="chapter" data-level="1.1" data-path="what-is-the-project-big-life-planning-tool.html"><a href="what-is-the-project-big-life-planning-tool.html"><i class="fa fa-check"></i><b>1.1</b> What is the Project Big Life Planning Tool</a></li>
<li class="chapter" data-level="1.2" data-path="who-made-the-project-big-life-planning-tool.html"><a href="who-made-the-project-big-life-planning-tool.html"><i class="fa fa-check"></i><b>1.2</b> Who made the Project Big Life Planning Tool?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>3</b> Getting Started</a></li>
<li class="chapter" data-level="4" data-path="howto.html"><a href="howto.html"><i class="fa fa-check"></i><b>4</b> How To</a><ul>
<li class="chapter" data-level="4.1" data-path="customize-data.html"><a href="customize-data.html"><i class="fa fa-check"></i><b>4.1</b> Customize Data</a></li>
<li class="chapter" data-level="4.2" data-path="load-data.html"><a href="load-data.html"><i class="fa fa-check"></i><b>4.2</b> Load Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="load-data.html"><a href="load-data.html#use-a-sample-file"><i class="fa fa-check"></i><b>4.2.1</b> Use a sample file</a></li>
<li class="chapter" data-level="4.2.2" data-path="load-data.html"><a href="load-data.html#load-your-own-file"><i class="fa fa-check"></i><b>4.2.2</b> Load your own file</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="select-outcome.html"><a href="select-outcome.html"><i class="fa fa-check"></i><b>4.3</b> Select Outcome</a></li>
<li class="chapter" data-level="4.4" data-path="filter-data.html"><a href="filter-data.html"><i class="fa fa-check"></i><b>4.4</b> Filter Data</a><ul>
<li class="chapter" data-level="4.4.1" data-path="filter-data.html"><a href="filter-data.html#remove-a-filter"><i class="fa fa-check"></i><b>4.4.1</b> Remove a filter</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="stratify-data.html"><a href="stratify-data.html"><i class="fa fa-check"></i><b>4.5</b> Stratify data</a></li>
<li class="chapter" data-level="4.6" data-path="calculate-outcomes.html"><a href="calculate-outcomes.html"><i class="fa fa-check"></i><b>4.6</b> Calculate Outcomes</a></li>
<li class="chapter" data-level="4.7" data-path="generate-intervention-scenarios.html"><a href="generate-intervention-scenarios.html"><i class="fa fa-check"></i><b>4.7</b> Generate Intervention Scenarios</a></li>
<li class="chapter" data-level="4.8" data-path="visualize-data.html"><a href="visualize-data.html"><i class="fa fa-check"></i><b>4.8</b> Visualize Data</a></li>
<li class="chapter" data-level="4.9" data-path="export-data.html"><a href="export-data.html"><i class="fa fa-check"></i><b>4.9</b> Export Data</a></li>
<li class="chapter" data-level="4.10" data-path="resolve-warning-or-error-messages.html"><a href="resolve-warning-or-error-messages.html"><i class="fa fa-check"></i><b>4.10</b> Resolve Warning or Error Messages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a><ul>
<li class="chapter" data-level="5.1" data-path="cause-deleted-life-expectancy.html"><a href="cause-deleted-life-expectancy.html"><i class="fa fa-check"></i><b>5.1</b> Cause-deleted life expectancy</a></li>
<li class="chapter" data-level="5.2" data-path="health-status-report.html"><a href="health-status-report.html"><i class="fa fa-check"></i><b>5.2</b> Health Status Report</a></li>
<li class="chapter" data-level="5.3" data-path="diet.html"><a href="diet.html"><i class="fa fa-check"></i><b>5.3</b> Diet</a></li>
<li class="chapter" data-level="5.4" data-path="transportation.html"><a href="transportation.html"><i class="fa fa-check"></i><b>5.4</b> Transportation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="keyconcepts.html"><a href="keyconcepts.html"><i class="fa fa-check"></i><b>6</b> Key Concepts</a><ul>
<li class="chapter" data-level="6.1" data-path="data-and-sample-files.html"><a href="data-and-sample-files.html"><i class="fa fa-check"></i><b>6.1</b> Data and sample files</a><ul>
<li class="chapter" data-level="6.1.1" data-path="data-and-sample-files.html"><a href="data-and-sample-files.html#sample-files"><i class="fa fa-check"></i><b>6.1.1</b> Sample Files</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="multivariable-predictive-risk-algorithms.html"><a href="multivariable-predictive-risk-algorithms.html"><i class="fa fa-check"></i><b>6.2</b> Multivariable predictive risk algorithms</a><ul>
<li class="chapter" data-level="6.2.1" data-path="multivariable-predictive-risk-algorithms.html"><a href="multivariable-predictive-risk-algorithms.html#development-of-multivariable-predictive-risk-algorithms"><i class="fa fa-check"></i><b>6.2.1</b> Development of multivariable predictive risk algorithms</a></li>
<li class="chapter" data-level="6.2.2" data-path="multivariable-predictive-risk-algorithms.html"><a href="multivariable-predictive-risk-algorithms.html#multivariable-predictive-risk-algorithms-built-in-project-big-life-planning-tool"><i class="fa fa-check"></i><b>6.2.2</b> Multivariable predictive risk algorithms built in Project Big Life Planning Tool</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="calculations.html"><a href="calculations.html"><i class="fa fa-check"></i><b>6.3</b> Calculations</a><ul>
<li class="chapter" data-level="6.3.1" data-path="calculations.html"><a href="calculations.html#risk-of-health-outcome"><i class="fa fa-check"></i><b>6.3.1</b> Risk of health outcome</a></li>
<li class="chapter" data-level="6.3.2" data-path="calculations.html"><a href="calculations.html#number-of-health-outcomes"><i class="fa fa-check"></i><b>6.3.2</b> Number of health outcomes</a></li>
<li class="chapter" data-level="6.3.3" data-path="calculations.html"><a href="calculations.html#life-expectancy-calculation"><i class="fa fa-check"></i><b>6.3.3</b> Life expectancy calculation</a></li>
<li class="chapter" data-level="6.3.4" data-path="calculations.html"><a href="calculations.html#cause-deletion-calculations"><i class="fa fa-check"></i><b>6.3.4</b> Cause-deletion calculations</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="health-interventions-scenarios.html"><a href="health-interventions-scenarios.html"><i class="fa fa-check"></i><b>6.4</b> Health interventions scenarios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="glossary.html"><a href="glossary.html"><i class="fa fa-check"></i><b>7</b> Glossary</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="mortality-population-risk-tool-mport.html"><a href="mortality-population-risk-tool-mport.html"><i class="fa fa-check"></i><b>A</b> Mortality Population Risk Tool (MPoRT)</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Planning Tool Guidance</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="calculations" class="section level2">
<h2><span class="header-section-number">6.3</span> Calculations</h2>
<div id="risk-of-health-outcome" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Risk of health outcome</h3>
<p>Risk of the health outcome (e.g. risk of dying) is the outcome of the multivariable predictive risk algorithm. An example of the mutlivariable risk algorithm is:</p>
<p><span class="math display">\[ \text{Risk} = \sum_t h_0(t) * e^{\beta_{pred.smoking}*x_{smoking}+\beta_{pred.cancer}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span> Where:</p>
<ul>
<li><span class="math inline">\(t\)</span> = survival time</li>
<li><span class="math inline">\(h_0(t)\)</span> = the baseline hazard</li>
<li><span class="math inline">\(\beta_{pred}\)</span> = predictive hazard ratios for the exposures</li>
<li><span class="math inline">\(x\)</span> = the exposure (e.g. <span class="math inline">\(x_{smoking}\)</span> can have the value: current smoker, former smoker &lt;=5 years, former smoker &gt; 5 years, or never smoker).</li>
</ul>
</div>
<div id="number-of-health-outcomes" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Number of health outcomes</h3>
<p>The number of health outcomes (e.g. Summary Deaths) is calculated through the following steps:</p>
<ol style="list-style-type: decimal">
<li>Risk of the health outcome is calculated for each individual in the dataset using the mutlivariable predictive risk algorithm.</li>
<li>The weighted mean of all the risks is calculated using individual risk values and corresponding study weights (CCHS variable: WTS_M).</li>
<li>The weighted mean is then multiplied with the total number of individuals in the population to generate the number of health outcomes (e.g. number of deaths in 5 years).</li>
</ol>
</div>
<div id="life-expectancy-calculation" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Life expectancy calculation</h3>
<p>Life expectancy is calculated using abridge life tables:</p>
<ol style="list-style-type: decimal">
<li>The mortality risk for each individual is calculated using the mutlivariable predictive risk algorithm for mortality (MPoRT - details can be found in Appendix A).</li>
<li>Mortality risks for each individual are weighted using the corresponding survey weights (CCHS variable - WTS_M).</li>
<li>Weighted mortality risks are then used in sex-specific 5-year abridge period life tables.</li>
<li>Life expectancy was then calculated using these 5-year abridge period life tables.</li>
</ol>
</div>
<div id="cause-deletion-calculations" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Cause-deletion calculations</h3>
<p>What would be the life expectancy of a population if be no one in the population ever smoked? This scenario is a cause-deleted scenario.</p>
<p><em>To Do: Insert video of cause deleted calculations that explains Method 1 vs. Method 2</em></p>
<p>There are two parts to the cause-deleted calculations: (A) calculate the risk, and (B) calculate the health outcome: life expectancy or number of deaths.</p>
<p><strong>Part A: Risk calculations</strong></p>
<p>The original multivariable predictive risk algorithm is:</p>
<p><span class="math display">\[ \text{Risk} = \sum_t h_0(t) * e^{\beta_{pred.smoking}*x_{smoking}+\beta_{pred.cancer}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span></p>
<p><strong>Step 1.</strong> Modify the original algorithm to include the external coefficient(s). This means replacing all predictive hazard ratios/betas related to the health behaviour to the causal hazard ratios/betas.</p>
<ul>
<li>Remove the original regression coefficient(s) for the health behaviour.</li>
<li>Add the new external coefficient(s) to the algorithm. External coefficients are generated from either: causal models, or from systematic reviews or meta-analysis.</li>
</ul>
<p><span class="math display">\[ \text{External coefficient risk} = \sum_t h_0(t) * e^{{\beta_\textbf{causal.smoking}}*x_{smoking} + {{\beta_\textbf{causal.cancer}}}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span></p>
<p><strong>Step 2.</strong> Risk is calculated using the modified algorithm created in Step 1 and the respondent’s original profile (e.g. current smoker). This is the “external coefficient risk”.</p>
<p><span class="math display">\[ \text{External coefficient risk} = \sum_t h_0(t) * e^{\beta_{causal.smoking}* {(\textbf{current smoker})} + \beta_{causal.cancer}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span></p>
<p><strong>Step 3.</strong> “Cause-deleted risk’” is calculated by setting an exposure to a reference (non-exposed) value (all other risk exposures remain unchanged).</p>
<p><span class="math display">\[ \text{Cause-deleted risk&#39; } = \sum_t h_0(t) * e^{\beta_{causal.smoking}* {(\textbf{never smoker})} + \beta_{causal.cancer}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span></p>
<p><strong>Step 4.</strong> The “cause-deleted effect external” is calculated as “external coefficient risk” (Step 2) minus the “cause-deleted risk’.”(Step 3).</p>
<p><span class="math display">\[\text{Cause-deleted effect}_{external} = \text{External coefficient risk} - \text{Cause-deleted risk&#39;}\]</span></p>
<p><strong>Step 5.</strong> Original risk is calculated using the original algorithm and the original respondent’s profile.</p>
<p><span class="math display">\[ \text{Original risk} = \sum_t h_0(t) * e^{{\beta_\textbf{pred.smoking}}*{(\textbf{current smoker})}+{\beta_\textbf{pred.cancer}}*x_{cancer} + \beta_{pred.male}*x_{male} +...}  \]</span></p>
<p><strong>Step 6.</strong> The “cause-deleted risk external” is calculated by “original risk” (Step 5) minus the “cause-deleted effect external” (Step 4).</p>
<p><span class="math display">\[\text{Cause-deleted risk}_{ external} = \text{Original risk} - \text{Cause-deleted effect}_{external}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="Method2%20only%20-cbf.jpg" alt="Risk part of the cause-deleted calculations"  />
<p class="caption">
Figure 6.1: Risk part of the cause-deleted calculations
</p>
</div>
<p><strong>Part B: Health outcome calculations</strong></p>
<p>Using risks generated above you can then calculate:</p>
<ul>
<li>cause-deleted life expectancy or life years lost attributable to a health behaviour (exposure)</li>
<li>cause-deleted number of deaths or number of deaths attributable to a health behaviour (exposure)</li>
</ul>
<p><strong>Life expectancy calculations</strong></p>
<p>Step I: Calculate the original life expectancy by using the original risk (Step 5 above) in the sex-specific 5-year abridge period life tables.</p>
<p>Step II: Calculate the cause-deleted life expectancy by using the cause-deleted risk external (Step 6 above) in the sex-specific 5-year abridge period life tables.</p>
<p>Step III: Calculate life years lost attributable to a health behaviour by: original life expectancy (Step I) minus cause-deleted life expectancy (Step II):</p>
<p><span class="math display">\[ \text{Life years lost} = \text{Original life expectancy} - \text{Cause-deleted life expectancy}\]</span></p>
<p><strong>Number of deaths calculations</strong></p>
<p>Step I: Calculate the number of deaths that would occur using the original risk (Step 5 above).</p>
<p>Step II: Calculate the number of deaths that would occur using the cause-deleted risk external (Step 6 above).</p>
<p>Step III: Calculate the number of deaths that are attributable to a health behaviour (exposure) by: original number of deaths (Step I) minus cause-deleted number of deaths (Step II):</p>
<p><span class="math display">\[\text{Deaths due to exposure} = \text{Original number of deaths} - \text{Cause-deleted number of deaths}\]</span></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariable-predictive-risk-algorithms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="health-interventions-scenarios.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-Key-Concepts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-BATCH_Guidance.pdf", "bookdown-BATCH_Guidance.epub"],
"toc": {
"collapse": "section"
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
